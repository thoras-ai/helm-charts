---
thorasVersion: "4.64.4"
cluster:
  name: ""

imageCredentials:
  registry: "us-east4-docker.pkg.dev/thoras-registry/platform"
  username: "_json_key_base64"

  # Set the license key directly as a variable (or alternatively
  # use imageCredentials.secretRef to reference an existing secret
  password: ""

  # Reference a pre-existing secret in the Thoras namespace
  secretRef: ""

resourceQuota:
  enabled: false
  pods: 200
  cronjobs: 200
  jobs: 200

imagePullPolicy: "IfNotPresent"

logLevel: info

featureFlags:
  enableNodeDetailsCollector: false
  enableSkipScalingOnInsufficientData: true
  enableCheckDatabaseHealth: false
  enableCostSavingsSettingsRefresh: false

# Cost refresh batching configuration (shared by thorasApiServerV2 and thorasWorker)
costRefreshBatching:
  enabled: true
  batchSize: 200
  maxConcurrency: 5

# Enable Slack errors
slackErrorsEnabled: false

# Set Slack notification Webhook URL directly (or alternatively use
# use slackWebhookUrlSecretRef to reference an existing secret
slackWebhookUrl: ""

# If you'd like to reference an existing secret, use these two values
# to indicate the secret name and data key
slackWebhookUrlSecretRefName: ""
slackWebhookUrlSecretRefKey: ""

cloudSync:
  clusterKeyID: ""

  # Set cluster key directly (or alternatively use use clusterKeySecretRef to
  # reference an existing secret. Sync is disabled if no cluster key is
  # provided.
  clusterKey: ""

  # If you'd like to reference an existing secret, use these two values to
  # indicate the secret name and data key
  clusterKeySecretRefName: ""
  clusterKeySecretRefKey: ""

rbac:
  namespaces: []

thorasOperator:
  replicas: 1
  serviceAccount:
    name: thoras-operator
  podAnnotations: {}
  labels: {}
  # Specify the complete resources block (takes precedence if set)
  resources: {}
  # Legacy field for backward compatibility (used if resources is empty)
  limits:
    memory: 2Gi
  # Legacy field for backward compatibility (used if resources is empty)
  requests:
    cpu: 100m
    memory: 128Mi
  prometheus:
    enabled: true
    port: 9101
  # Set to true to apply global affinity rules to this component
  useGlobalAffinity: true
  # Component-specific affinity (merged with global if useGlobalAffinity is true)
  affinity: {}
  # Webhook certificate generation configuration
  webhookCertGen:
    imageTag: v1.4.4

metricsCollector:
  persistence:
    enabled: false
    volumeName: ""
    storageClassName: "efs-sc-thoras"
    accessMode: "ReadWriteOnce"
    createEFSStorageClass:
      fileSystemId: ""
    pvcStorageRequestSize: "3Gi"
  podAnnotations: {}
  labels: {}
  serviceAccount:
    name: thoras-collector
  init:
    imageTag: "3.23.0"
    # Specify the complete resources block (takes precedence if set)
    resources: {}
    # Legacy field for backward compatibility (used if resources is empty)
    limits:
      memory: "8192Mi"
    # Legacy field for backward compatibility (used if resources is empty)
    requests:
      cpu: "16m"
      memory: "32Mi"
  timescale:
    image: "timescaledb"
    imageTag: "2.24.0-pg16"
    extensionVersion: "2.24.0"
    name: timescale
    containerPort: 5432
    # Specify the complete resources block (takes precedence if set)
    resources: {}
    # Legacy field for backward compatibility (used if resources is empty)
    limits:
      memory: "16384Mi"
    # Legacy field for backward compatibility (used if resources is empty)
    requests:
      cpu: "1024m"
      memory: "3072Mi"
    config:
      enabled: false
      content: ""
  blobService:
    logLevel: "info"
    pprof:
      enabled: false
    containerPort: 8080
    port: 80
    # Specify the complete resources block (takes precedence if set)
    resources: {}
    # Legacy field for backward compatibility (used if resources is empty)
    limits:
      memory: "8192Mi"
    # Legacy field for backward compatibility (used if resources is empty)
    requests:
      cpu: "16m"
      memory: "128Mi"
  additionalPvSecurityContext: {}
  # Set to true to apply global affinity rules to this component
  useGlobalAffinity: true
  # Component-specific affinity (merged with global if useGlobalAffinity is true)
  affinity: {}

thorasApiServerV2:
  rbac:
    create: true
  serviceAccount:
    name: thoras-api
  containerPort: 8080
  podAnnotations: {}
  labels: {}
  replicas: 1
  # Specify the complete resources block (takes precedence if set)
  resources: {}
  # Legacy field for backward compatibility (used if resources is empty)
  limits:
    memory: 2Gi
  # Legacy field for backward compatibility (used if resources is empty)
  requests:
    cpu: 128m
    memory: 256Mi
  port: 80
  logLevel: "info"
  additionalPvSecurityContext: {}
  prometheus:
    enabled: true
  pprof:
    enabled: false
  enableViewCacheQueryLiveJoin: true
  # Set to true to apply global affinity rules to this component
  useGlobalAffinity: true
  # Component-specific affinity (merged with global if useGlobalAffinity is true)
  affinity: {}

thorasWorker:
  enabled: true
  serviceAccount:
    name: thoras-worker
  podAnnotations: {}
  labels: {}
  replicas: 1
  # Specify the complete resources block (takes precedence if set)
  resources: {}
  # Legacy field for backward compatibility (used if resources is empty)
  limits:
    memory: 2Gi
  # Legacy field for backward compatibility (used if resources is empty)
  requests:
    cpu: 128m
    memory: 256Mi
  logLevel: "info"
  prometheus:
    enabled: true
    port: 9102
  enableSnapshotChunkAutoSizing: true
  # Cost will not work in the dashboard if this is disabled. Used for debugging purposes.
  enableAstViewCacheRefreshWorker: true
  enableAstViewCacheStateReconcilerWorker: true
  enableMetricIntegrityWorker: false
  enableActiveSuggestionWorker: false
  enableUnifiedAstUtilizationMonitor: false
  cloudSyncBaseUrl: "https://console.staging.thoras.ai"
  # Set to true to apply global affinity rules to this component
  useGlobalAffinity: true
  # Component-specific affinity (merged with global if useGlobalAffinity is true)
  affinity: {}

thorasDashboard:
  enabled: true
  serviceAccount:
    name: thoras-dashboard
    create: true
  rbac:
    create: true
  podAnnotations: {}
  labels: {}
  containerPort: 5173
  nginxContainerPort: 80
  nginx:
    imageTag: "1.29.4-alpine3.23-slim"
  # Specify the complete resources block (takes precedence if set)
  resources: {}
  # Legacy field for backward compatibility (used if resources is empty)
  limits:
    memory: 2Gi
  # Legacy field for backward compatibility (used if resources is empty)
  requests:
    cpu: 100m
    memory: 128Mi
  port: 80
  replicas: 1
  service:
    type: ClusterIP
    annotations: {}
  ingress:
    enabled: false
    ingressClassName: "nginx"
    annotations: {}
    hosts:
      - host: thoras.local
        paths:
          - path: /
            pathType: Prefix
    tls: []
  gatewayAPI:
    enabled: false
    annotations: {}
    parentRefs:
      - name: gateway
        namespace: default
    hostnames:
      - thoras.local
    path: /
    pathType: PathPrefix
  extras:
    show_savings: true
    cost_analysis: true
    cost_simulator: false
    rolling_savings: true
    cost_breakdown_v2: true
  # Set to true to apply global affinity rules to this component
  useGlobalAffinity: true
  # Component-specific affinity (merged with global if useGlobalAffinity is true)
  affinity: {}

thorasMonitor:
  enabled: false
  serviceAccount:
    name: thoras-monitor
  unittesting: false
  # Specify the complete resources block (takes precedence if set)
  resources: {}
  # Legacy field for backward compatibility (used if resources is empty)
  limits:
    memory: "8192Mi"
  # Legacy field for backward compatibility (used if resources is empty)
  requests:
    cpu: "16m"
    memory: "64Mi"
  podAnnotations: {}
  labels: {}
  config: |
  # Set to true to apply global affinity rules to this component
  useGlobalAffinity: true
  # Component-specific affinity (merged with global if useGlobalAffinity is true)
  affinity: {}

thorasForecast:
  serviceAccount:
    name: thoras-forecast-worker
  skipCache: false
  ignoreNewPods: true
  podEligibilityMinRunningTime: "2m"
  enableDecoupledTraining: true
  trainingJitterMinutes: 0
  # Specify the complete resources block (takes precedence if set)
  resources: {}
  # Legacy field for backward compatibility (used if resources is empty)
  requests:
    cpu: "256m"
    memory: "256Mi"
  # Legacy field for backward compatibility (used if resources is empty)
  limits:
    memory: "8Gi"
    cpu: "4"
  worker:
    replicas: 1
    pollingInterval: 15
    podAnnotations: {}
    retrainSteadyStateHours: ""
    retrainOverrideHours: ""
    maxTimeseriesMetricCacheSizeMb: 1000
    labels: {}
    # Specify the complete resources block (takes precedence if set)
    resources: {}
    # Legacy field for backward compatibility (used if resources is empty)
    limits:
      memory: 2Gi
      cpu: 2
    # Legacy field for backward compatibility (used if resources is empty)
    requests:
      cpu: 1
      memory: 256Mi
    forecastTimeout: 600
  prometheus:
    enabled: true
    port: 9101
  # Set to true to apply global affinity rules to this component
  useGlobalAffinity: true
  # Component-specific affinity (merged with global if useGlobalAffinity is true)
  affinity: {}

thorasAgent:
  enabled: false
  serviceAccount:
    name: thoras-agent
  frequency: 15
  containerPort: 9101
  # Specify the complete resources block (takes precedence if set)
  resources: {}
  # Legacy field for backward compatibility (used if resources is empty)
  limits:
    memory: 128Mi
  # Legacy field for backward compatibility (used if resources is empty)
  requests:
    cpu: 100m
    memory: 128Mi
  securityContext: {}
  podAnnotations: {}
  labels: {}
  priorityClassName: ~

thorasReasoning:
  connectors:
    prometheus:
      baseUrl: "http://localhost"

thorasSlmAgent:
  enabled: false
  serviceAccount:
    name: thoras-slm-api
  podAnnotations: {}
  labels: {}
  containerPort: 11434
  port: 8080
  # Specify the complete resources block (takes precedence if set)
  resources: {}
  # Legacy field for backward compatibility (used if resources is empty)
  limits:
    memory: 8192Mi
  # Legacy field for backward compatibility (used if resources is empty)
  requests:
    cpu: 1024m
    memory: 4096Mi
  # Set to true to apply global affinity rules to this component
  useGlobalAffinity: true
  # Component-specific affinity (merged with global if useGlobalAffinity is true)
  affinity: {}

# K8s client max queries per second
queriesPerSecond: "50"

# nodeSelector is used to assign components to specific nodes
nodeSelector: {}

tolerations: []

# Global affinity rules that components can opt into
affinity: {}

# Global Labels support
labels: {}
